doctype html

<!-- @if production=false -->
html
<!-- @endif -->

<!-- @if production=true -->
html(manifest="offline/cache.appcache")
<!-- @endif -->

    head
        
        meta(charset="UTF-8")

        title
     
        link(rel="shortcut icon", href="images/favicon_256x256.png", type="image/png")

        <!-- @if production=false -->
        // Top JS

        script(src="js_vendor/jquery.js")
        script(src="js_vendor/jquery-ui.js")
        script(src="js_vendor/leaflet-src.js")
        script(src="js_vendor/FileSaver.js")
        script(src="js_vendor/base64.js ")
        script(src="js_vendor/pouchdb.js")
        script(src="js_vendor/jquery.noty.js")
        script(src="js_vendor/jquery.noty.bottomRight.js")
        script(src="js_vendor/bootstrap-tagsinput.js")
        script(src="js_vendor/hammer.js")
        script(src="js_vendor/jquery.hammer.js")
        script(src="js_vendor/leaflet.measure.js")
        script(src="js_vendor/jquery.arcticmodal-0.3.min.js")
        script(src="js_vendor/modernizr.js")
        script(src="js_vendor/shortcut.js")
        script(src="js_vendor/leaflet.markercluster-src.js")
        script(src="js_vendor/moment-with-langs.js")
        //script(src="js_vendor/tinymce/tinymce.min.js")
        //script(src="js_vendor/ckeditor/ckeditor.js")
        script(src="js_vendor/jquery.dataTables.min.js")
        script(src="js_vendor/jquery.datetimepicker.js")

        // CSS    
        
        link(href="css_vendor/leaflet.css", rel="stylesheet")
        link(href="css_vendor/jquery-ui.css", rel="stylesheet")
        link(href="css_vendor/leaflet.measure.css", rel="stylesheet")
        link(href="css_vendor/jquery.arcticmodal-0.3.css", rel="stylesheet")
        link(href="css_vendor/foundation.css", rel="stylesheet")
        link(href="css_vendor/normalize.css", rel="stylesheet")
        link(href="css_vendor/animate.css", rel="stylesheet")
        link(href="css_vendor/MarkerCluster.Default.css", rel="stylesheet")
        link(href="css_vendor/jquery.dataTables.css", rel="stylesheet")
        link(href="css_vendor/jquery.datetimepicker.css", rel="stylesheet")


        link(href="css/starik.kartofan.main.css", rel="stylesheet")
        link(href="css/starik.kartofan.menu.css", rel="stylesheet")
        link(href="css/starik.kartofan.forms.css", rel="stylesheet")
        link(href="css/starik.kartofan.fonts.css", rel="stylesheet")
        <!-- @endif -->

        <!-- @if production=true -->

        script(src="top.js")
        link(href="vendor.css", rel="stylesheet")
        link(href="app.css", rel="stylesheet")

        <!-- @endif -->

    body

        div#loaderText(style="font: 30px fantasy !important; text-align: center;")
            h1 Loading... about 2MB. Be patient it`s dev version.
            h1 Загружается... около 2Мб. Будьте терпеливы это же тестовая версия.

        div#topMenuKartofan.hide
            nav.top-bar(data-topbar, data-options="is_hover: false")
                ul.title-area 
                    li.name: h1: a#canvasDownload Kartofan
                    li.toggle-topbar.menu-icon: a: span.topMenuMenu Menu

                section.top-bar-section

                    ul.left
                        li#topMenuMapSetTour: a.topMenuMapSet: span.icon-map
                        li#topMenuStageSetTour: a.topMenuStageSet: span.icon-grid
                        li#topMenuMoveMoveTour: a.topMenuMoveMove: span.icon-aim
                        li#topMenuUtilsToggleFulscreenTour: a.topMenuUtilsToggleFulscreen: span.icon-arrows-out
                        li#topMenuUtilsToggleMeasuringTour: a.topMenuUtilsToggleMeasuring: span.icon-crop-streamline
                        li: a.topMenuSetCache: span.icon-picture-streamline-1
                        //li: a.topMenuStageExport Export Stage Like Image
                        li: a.topMenuMarkerAdd: span.icon-pin

                    ul.right
                        li.has-dropdown.hide-for-small-only.hide-for-medium-up.hide-for-large-up.hide-for-xlarge-up.hide-for-xxlarge-up#topMenuStageEditor
                            a: span.topMenuStageEditor Stage Editor
                            ul.dropdown 
                                li: a.topMenuStageEditorSaveView Save View
                                li: a.topMenuStageEditorAddMap Add Map To Stage
                                li: a.topMenuStageEditorRemoveMap Remove Map From Stage
                                li: a.topMenuStageEditorEditControls Edit Controls On Selected Map
                                li: a.topMenuStageEditorToggleBlockZoom Toggle Blocking Zoom on Active Map

                        li.has-dropdown.hide-for-small-only.hide-for-medium-up.hide-for-large-up.hide-for-xlarge-up.hide-for-xxlarge-up#topMenuCoordsCorrection
                            a: span.topMenuCoordsCorrection Coords Correction
                            ul.dropdown 
                                li: a.topMenuCoordsCorrectionAddRight Add Right Coord
                                li: a.topMenuCoordsCorrectionAddWrong Add Wrong Coord
                                li: a.topMenuCoordsCorrectionRemoveMarkers Remove Markers
                                li: a.topMenuCoordsCorrectionSaveCorrections Save corrections
                                li: a.topMenuCoordsCorrectionDropCorrectionSelect Drop Correction on Visible Maps
                                li: a.topMenuCoordsCorrectionClose Close Menu

                        li: a.topMenuHelpTourMain.button.alert.hide-for-small-only.hide-for-medium-up.hide-for-large-up.hide-for-xlarge TourMain
                        li.divider
                        li: a.topMenuHelpUpdates.button.alert.hide-for-small-only.hide-for-medium-up.hide-for-large-up.hide-for-xlarge Updates

                        li.has-dropdown#topMenuMenuTour
                            a: span.topMenuMenu Menu
                            ul.dropdown 
                                li.has-dropdown
                                    a.topMenuMaps Maps 
                                    ul.dropdown
                                        li: a.topMenuMapSet Set Map
                                        li: a.topMenuMapEdit Edit Map
                                        li: a.topMenuMapExternal Get External Map
                                        li: a.topMenuMapSave Save Map
                                li.has-dropdown
                                    a.topMenuStages Stages 
                                    ul.dropdown 
                                        li: a.topMenuStageSet Set Stage
                                        li: a.topMenuStageEdit Edit Stage
                                        li: a.topMenuStageExternal Get External Stage
                                        li: a.topMenuStageEditView Edit This Stage View
                                        li: a.topMenuStageSave Save This Stage
                                        li: a.topMenuStageExport Export Stage Like Image
                                li.has-dropdown
                                    a.topMenuUtils Utils
                                    ul.dropdown 
                                        li: a.topMenuUtilsToggleFulscreen Toggle Fullscreen Select Map
                                        li: a.topMenuUtilsToggleMeasuring Measuring
                                        li: a.topMenuUtilsFastNotes Fast Notes
                                        li: a.topMenuUtilsCoordsCorrection Coords Correction
                                        li: a.topMenuUtilsMarkersTable Editing Markers Table
                                li.has-dropdown
                                    a.topMenuMove Moves 
                                    ul.dropdown 
                                        li: a.topMenuMoveMove Move To
                                        li: a.topMenuMoveAdd Add Move
                                        li: a.topMenuMoveEdit Edit Move
                                li.has-dropdown#topMenuOpt
                                    a.topMenuOpt Settings
                                    ul.dropdown 
                                        li: a.topMenuOptUpdate Update Options From External Base
                                        li: a.topMenuOptLang Set Language 
                                        li: a.topMenuOptReset Reset All Settings
                                        li.divider
                                        li: a.topMenuOptHashChange Addres Bar Coords Change
                                        li: a.topMenuOptMapsSyncMoving Maps Sync Moving
                                        li: a.topMenuOptMapSyncZooming Map Sync Zooming 
                                        li: a.topMenuOptMapCursorAllMapsVisible Map Cursor On All Maps Visible 
                                        li: a.topMenuOptViewInfoPanelShowAlways Info Panel Show Always 
                                        li: a.topMenuOptDbSyncIn Db Sync In 
                                        li: a.topMenuOptDbSyncOut Db Sync Out 
                                        li: a.topMenuOptGpsAutoStart GPS Auto Start
                                        li: a.topMenuOptSHowMarkers Show Markers
                                        li: a.topMenuOptSaveCorrections Save Coords Corrections
                                        li.divider
                                        li: a.topMenuSetCache Map Cached Type
                                        li: a.topMenuMapCachedService Set Map Cached Service
                                        li: a.topMenuMapDefaultCenterLatLng Set Map Default Center LatLng 
                                        li: a.topMenuMapDefaultURL Set Map Default URL
                                        li: a.topMenuMainFeed Set Main Feed

                                li.has-dropdown
                                    a.topMenuJSON JSON 
                                    ul.dropdown 
                                        li: a.topMenuJSONMaps Get All External Maps
                                        li: a.topMenuJSONStages Get All External Stages
                                        li: a.topMenuJSONMoves Get All External Moves 
                                        li: a.topMenuJSONAll Get All From JSON
                                        li: a.topMenuJSONExport Export All Data To JSON
                                        li: a.topMenuJSONRawText Get Data From Text
                                li.has-dropdown
                                    a.topMenuGPS GPS 
                                    ul.dropdown 
                                        li: a.topMenuGPSStart GPS Start
                                        li: a.topMenuGPSStop GPS Stop
                                li.has-dropdown
                                    a.topMenuHelp Help 
                                    ul.dropdown 
                                        li: a.topMenuHelpComments Add Comment On Site  
                                        li: a.topMenuHelpBlog(href="http://kartofan-blog.blogspot.com/", target="_blank") Blog                                        
                                        li: a.topMenuHelpFAQ(href="http://kartofan.comuf.com/qa/", target="_blank") Site Questions And Answers
                                        li: a.topMenuHelpSource(href="https://github.com/starikan/kartofan", target="_blank") Sources on GitHub
                                        li: a.topMenuHelpHotkeys Hotkeys List
                                        li: a.topMenuHelpTourMain TourMain
                                        li: a.topMenuHelpUpdates Updates
                                        li: a.topMenuVersion Version
                            
                            li.has-dropdown#topMenuHelp
                                a.icon-iconic-10.topMenuHelp
                                ul.dropdown 
                                    li: a.topMenuHelpComments Add Comment On Site   
                                    li: a.topMenuHelpBlog(href="http://kartofan-blog.blogspot.com/", target="_blank") Blog
                                    li: a.topMenuHelpFAQ(href="http://kartofan.comuf.com/qa/", target="_blank") Site Questions And Answers
                                    li: a.topMenuHelpSource(href="https://github.com/starikan/kartofan", target="_blank") Sources on GitHub
                                    li: a.topMenuHelpHotkeys Hotkeys List
                                    li: a.topMenuHelpTourMain Tour Main  
                                    li: a.topMenuHelpUpdates Updates
                                    li: a.topMenuVersion Version

                            li#topMenuPin: a.icon-iconic.topMenuPin

        div#formEditMap.foundationForm.hide
            div.box-modal
                form(data-abide)
                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditMap_id ID
                        div.small-9.columns: input.formEditMap_id(type="text", required)

                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditMap_title Title
                        div.small-9.columns: input.formEditMap_title(type="text", required)

                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditMap_server Server
                        div.small-9.columns: select.formEditMap_server

                    div.row.collapse
                        div.small-3.columns: span.prefix.formEditMap_layers Layers
                        div.small-9.columns: input.formEditMap_layers(type="text")

                    div.row.collapse
                        div.small-3.columns: span.prefix.formEditMap_group Group
                        div.small-9.columns: input.formEditMap_group(type="text")

                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditMap_src Source
                        div.small-9.columns: select.formEditMap_src

                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditMap_crs CRS
                        div.small-9.columns: select.formEditMap_crs

                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditMap_tilesURL Tiles URL
                        div.small-9.columns: textarea.formEditMap_tilesURL(required)

                    div.row.collapse
                        div.small-3.columns: span.prefix.formEditMap_maxZoom maxZoom
                        div.small-9.columns: input.formEditMap_maxZoom(type="text", required, pattern="^1?\\d$|^20$")

                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditMap_minZoom minZoom
                        div.small-9.columns: input.formEditMap_minZoom(type="text", required, pattern="^1?\\d$|^20$")

                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditMap_startZoom startZoom
                        div.small-9.columns: input.formEditMap_startZoom(type="text", required, pattern="^1?\\d$|^20$")

                    div.row.collapse 
                        div.small-12.medium-4.columns.text-center: a.small.button.formEditMap_submit Submit
                        div.small-12.medium-4.columns.text-center: a.small.button.formEditMap_delete Delete
                        div.small-12.medium-4.columns.text-center: a.small.button.formEditMap_cancel Cancel

        div#formEditStage.foundationForm.hide
            div.box-modal
                form(data-abide)
                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditStage_id ID
                        div.small-9.columns: input.formEditStage_id(type="text", required)

                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditStage_title Title
                        div.small-9.columns: input.formEditStage_title(type="text", required)

                    div.row.collapse
                        div.small-3.columns: span.prefix.formEditStage_group Group
                        div.small-9.columns: input.formEditStage_group(type="text")

                    div.row.collapse 
                        div.small-12.medium-4.columns.text-center: a.small.button.formEditStage_submit Submit
                        div.small-12.medium-4.columns.text-center: a.small.button.formEditStage_delete Delete
                        div.small-12.medium-4.columns.text-center: a.small.button.formEditStage_cancel Cancel

        div#formEditPoint.foundationForm.hide
            div.box-modal
                form(data-abide)
                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditPoint_id ID
                        div.small-9.columns: input.formEditPoint_id(type="text", required)

                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditPoint_title Title
                        div.small-9.columns: input.formEditPoint_title(type="text", required)

                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditPoint_latlng LatLng
                        div.small-9.columns: input.formEditPoint_latlng(type="text", required, pattern="^\\d+\\.\\d+,\\d+\\.\\d+$")

                    div.row.collapse
                        div.small-3.columns: span.prefix.formEditPoint_group Group
                        div.small-9.columns: input.formEditPoint_group(type="text")

                    div.row.collapse 
                        div.small-12.medium-4.columns.text-center: a.small.button.formEditPoint_submit Submit
                        div.small-12.medium-4.columns.text-center: a.small.button.formEditPoint_delete Delete
                        div.small-12.medium-4.columns.text-center: a.small.button.formEditPoint_cancel Cancel

        div#formEditMarker.foundationForm.hide
            div.box-modal
                form(data-abide)
                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditMarker_id ID
                        div.small-9.columns: input.formEditMarker_id(type="text", required)

                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditMarker_title Title
                        div.small-9.columns: input.formEditMarker_title(type="text", required)

                    div.row.collapse
                        div.small-3.columns: span.prefix.formEditMarker_icon Icon
                        div.small-9.columns
                            input#formEditMarker_iconSrc.hide.formEditMarker_icon(type="text")
                            div.panel#formEditMarker_iconsPanel

                    div.row.collapse
                        div.small-3.columns: span.prefix.formEditMarker_tags Tags
                        div.small-9.columns
                            // String with all tags
                            input#formEditMarker_tagsSrc.hide.formEditMarker_tags(type="text")
                            // Panel with tags buttons
                            div.panel#formEditMarker_tagsPanel
                            // Add tag section
                            div.row.collapse
                                div.small-10.columns: input#formEditMarker_tagsAddInput(type="text")
                                div.small-2.columns: a.button.tiny.postfix.nomargin#formEditMarker_tagsAddButton +

                    div.row.collapse
                        div.small-3.columns: span.prefix.formEditMarker_layer Layer
                        div.small-9.columns: input.formEditMarker_layer(type="text")

                    div.row.collapse
                        div.small-3.columns: span.prefix.formEditMarker_dateStart Date
                        div.small-9.columns
                            div.row.collapse
                                div.small-8.columns: input.formEditMarker_dateStart(type="text")
                                div.small-2.columns: a.button.tiny.postfix.nomargin.disabled.formEditMarker_dateStartAddTime: span.formEditMarker_dateStartAddTime +Time
                                div.small-2.columns: a.button.tiny.postfix.nomargin.formEditMarker_dateStartAddFinal: span.formEditMarker_dateStartAddFinal +End

                    div.row.collapse.hide#addDateFinalRow
                        div.small-3.columns: span.prefix.formEditMarker_dateEnd Date End
                        div.small-9.columns
                            div.row.collapse
                                div.small-8.columns: input.formEditMarker_dateEnd(type="text")
                                div.small-2.columns: a.button.tiny.postfix.nomargin.disabled.formEditMarker_dateEndAddTime: span.formEditMarker_dateEndAddTime +Time

                    div.row.collapse 
                        div.small-3.columns: span.prefix.formEditMarker_latlng Latlng
                        div.small-9.columns: input.formEditMarker_latlng(type="text", required)

                    div.row.collapse 
                        div.small-12.medium-4.columns.text-center: a.small.button.formEditMarker_submit Submit
                        div.small-12.medium-4.columns.text-center: a.small.button.formEditMarker_delete Delete
                        div.small-12.medium-4.columns.text-center: a.small.button.formEditMarker_cancel Cancel

        div#infoMenuKartofan.hide
            div.row
                div.columns.hide-for-small-only.medium-4: h6.infoMenuLatLng Coords
                div.columns.small-6.medium-4.text-center: h6.infoMenuTime Time
                div.columns.small-6.medium-4.text-right
                    h6.infoMenuVersion.right Version
                    h6.right |
                    h6.infoMenuCache.right Cache
                        

        div.mapContainer#containerKartofan.hide

        div#updatesInfo
        
        div#hotkeysInfo

        canvas#exportView.hide
        canvas#cutterView.hide
        //a#canvasDownload

        div#formRawJSON.foundationForm.hide
            div.box-modal
                form(data-abide)
                    div.row 
                        div.small-11.columns.small-centered: textarea.formRawJSON_rawJSON

                    div.row.center
                        div.small-6.columns.text-right: a.small.button.formRawJSON_submit Send 
                        div.small-6.columns.text-left: a.small.button.formRawJSON_cancel Cancel 

        div#fastNotes.hide
            div.row
                div.columns
                    div.panel#fastNotes_panel
                        textarea#fastNotes_textarea Пока не работает / Not working yet

        div#markersTable.modalPanel
            div.row
                div.columns.small-11.small-centered
                    div.panel
                        table#markersTable_panel
                            thead
                                tr
                                    th Id
                                    th Name
                                    th Tags
                                    th Icon
                                    th Group
                                    th Time
                            tbody
                                tr
                                    td Row1
                                    td Row1
                                    td Row1
                                    td Row1
                                    td Row1
                                    td Row1

        div#disqus_thread
        |<script type="text/javascript">
        |    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        |    var disqus_shortname = 'kartofan'; // required: replace example with your forum shortname
    
        |    /* * * DON'T EDIT BELOW THIS LINE * * */
        |    (function() {
        |        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        |        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        |        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        |    })();
        |</script>
        //<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        //<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    


        <!-- @if production=false -->
        // Bottom JS

        script(src="js_vendor/foundation.min.js")
        script(src="js/jquery.noty.kartofan.js")

        script(src="js/starik.kartofan.fn.js")
        script(src="js/starik.kartofan.leaflet.js")
        script(src="js/starik.kartofan.options.js")
        script(src="js/starik.kartofan.stages.js")
        script(src="js/starik.kartofan.forms.js")
        script(src="js/starik.kartofan.tour.js")
        script(src="js/starik.kartofan.gps.js")
        script(src="js/starik.kartofan.markers.js")
        script(src="js/starik.kartofan.main.js")
        <!-- @endif -->

        <!-- @if production=true -->

        script(src="bottom.js")

        <!-- @endif -->

        |<!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter22770301 = new Ya.Metrika({id:22770301, webvisor:true, clickmap:true, trackLinks:true, accurateTrackBounce:true, trackHash:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="//mc.yandex.ru/watch/22770301" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter -->

        |<script>
        |(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        |(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        |m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        |})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        |ga('create', 'UA-38067250-2', 'kissr.com');
        |ga('send', 'pageview');
        |</script>
